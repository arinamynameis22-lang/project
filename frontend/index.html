<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Система управления продажами автомобилей</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="bg-primary text-white py-3 shadow-sm">
    <div class="container">
      <h1 class="h4 mb-0">Система управления продажами автомобилей</h1>
    </div>
  </header>

  <main class="container py-4">
    <nav>
      <ul class="nav nav-tabs nav-fill flex-column flex-md-row" id="mainTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="cars-tab" data-bs-toggle="tab" data-bs-target="#cars" type="button" role="tab">Автомобили</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="movements-tab" data-bs-toggle="tab" data-bs-target="#movements" type="button" role="tab">Перемещения</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="sales-tab" data-bs-toggle="tab" data-bs-target="#sales" type="button" role="tab">Продажи</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button" role="tab">Отчёты</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="files-tab" data-bs-toggle="tab" data-bs-target="#files" type="button" role="tab">Загрузка файлов</button>
        </li>
      </ul>
    </nav>

    <div class="tab-content mt-4" id="mainTabsContent">
      <!-- Секция: Автомобили -->
      <section class="tab-pane fade show active" id="cars" role="tabpanel">
        <div class="d-flex flex-wrap gap-2 align-items-center mb-3">
          <button type="button" class="btn btn-primary" id="btnAddCar">Добавить автомобиль</button>
          <div class="d-flex align-items-center gap-2">
            <label class="form-label mb-0">Фильтр по статусу:</label>
            <select class="form-select form-select-sm" id="carsFilterStatus" style="width: auto;">
              <option value="">Все</option>
              <option value="на складе">На складе</option>
              <option value="продан">Продан</option>
              <option value="в демозале">В демозале</option>
              <option value="на сервисе">На сервисе</option>
            </select>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead class="table-light">
              <tr>
                <th>VIN</th>
                <th>Модель</th>
                <th>Цвет</th>
                <th>Цена закупки</th>
                <th>Цена продажи</th>
                <th>Статус</th>
                <th>Локация</th>
                <th>Действия</th>
              </tr>
            </thead>
            <tbody id="carsTableBody">
              <tr><td colspan="8" class="text-muted text-center">Загрузка...</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Секция: Перемещения -->
      <section class="tab-pane fade" id="movements" role="tabpanel">
        <h5 class="mb-3">Создать перемещение</h5>
        <form id="formMovement" class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Автомобиль (VIN)</label>
            <input type="text" class="form-control" id="movementVin" placeholder="VIN" maxlength="17" required>
          </div>
          <div class="col-md-3">
            <label class="form-label">Откуда</label>
            <select class="form-select" id="movementFrom" required>
              <option value="склад">склад</option>
              <option value="демозал">демозал</option>
              <option value="сервис">сервис</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">Куда</label>
            <select class="form-select" id="movementTo" required>
              <option value="склад">склад</option>
              <option value="демозал">демозал</option>
              <option value="сервис">сервис</option>
            </select>
          </div>
          <div class="col-md-2 d-flex align-items-end">
            <button type="submit" class="btn btn-primary w-100">Переместить</button>
          </div>
        </form>
        <h5 class="mb-3">История перемещений</h5>
        <div class="table-responsive">
          <table class="table table-striped">
            <thead class="table-light">
              <tr>
                <th>Дата</th>
                <th>VIN</th>
                <th>Откуда</th>
                <th>Куда</th>
              </tr>
            </thead>
            <tbody id="movementsTableBody">
              <tr><td colspan="4" class="text-muted text-center">Загрузка...</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Секция: Продажи -->
      <section class="tab-pane fade" id="sales" role="tabpanel">
        <h5 class="mb-3">Оформить продажу</h5>
        <form id="formSale" class="row g-3 mb-4">
          <div class="col-md-3">
            <label class="form-label">VIN автомобиля</label>
            <input type="text" class="form-control" id="saleVin" placeholder="VIN" maxlength="17" required>
          </div>
          <div class="col-md-2">
            <label class="form-label">Цена продажи</label>
            <input type="number" class="form-control" id="salePrice" min="0" step="1000" required>
          </div>
          <div class="col-md-3">
            <label class="form-label">ФИО покупателя</label>
            <input type="text" class="form-control" id="saleBuyerName" required>
          </div>
          <div class="col-md-2">
            <label class="form-label">Телефон</label>
            <input type="text" class="form-control" id="saleBuyerPhone" placeholder="+7 ...">
          </div>
          <div class="col-md-2 d-flex align-items-end">
            <button type="submit" class="btn btn-success w-100">Продать</button>
          </div>
        </form>
        <h5 class="mb-3">Проданные автомобили</h5>
        <div class="table-responsive">
          <table class="table table-striped">
            <thead class="table-light">
              <tr>
                <th>VIN</th>
                <th>Модель</th>
                <th>Цена продажи</th>
                <th>Покупатель</th>
              </tr>
            </thead>
            <tbody id="salesTableBody">
              <tr><td colspan="4" class="text-muted text-center">Загрузка...</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Секция: Отчёты -->
      <section class="tab-pane fade" id="reports" role="tabpanel">
        <div class="d-flex flex-wrap gap-2 mb-4">
          <button type="button" class="btn btn-outline-primary" id="btnReportSales">Отчёт о продажах</button>
          <button type="button" class="btn btn-outline-primary" id="btnReportStock">Отчёт об остатках</button>
          <button type="button" class="btn btn-outline-primary" id="btnReportBuyers">Отчёт о покупателях</button>
          <button type="button" class="btn btn-outline-secondary" id="btnReportOperations">Журнал операций</button>
        </div>
        <div class="card">
          <div class="card-header">Результат отчёта</div>
          <div class="card-body">
            <pre id="reportOutput" class="mb-0 p-3 bg-light rounded" style="max-height: 400px; overflow: auto;">Выберите отчёт и нажмите кнопку.</pre>
          </div>
        </div>
      </section>

      <!-- Секция: Загрузка файлов -->
      <section class="tab-pane fade" id="files" role="tabpanel">
        <div class="mb-3">
          <label class="form-label">Тип файла</label>
          <select class="form-select" id="fileUploadType" style="max-width: 200px;">
            <option value="arrivals">Поступления</option>
            <option value="movements">Перемещения</option>
            <option value="sales">Продажи</option>
            <option value="auto">Автоопределение</option>
          </select>
        </div>
        <div class="border border-2 rounded p-5 text-center bg-light" id="dropZone" role="button" tabindex="0" aria-label="Зона загрузки файла">
          <p class="text-muted mb-2">Перетащите CSV-файл сюда или нажмите для выбора</p>
          <input type="file" id="fileInput" accept=".csv,.txt" class="d-none">
          <button type="button" class="btn btn-outline-primary" id="btnSelectFile">Выбрать файл</button>
        </div>
        <div id="uploadResult" class="mt-3"></div>
      </section>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script src="app.js"></script>
</body>
</html>
